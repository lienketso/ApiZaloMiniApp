<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Frontend Debug Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 15px; margin: 5px; border: none; border-radius: 3px; cursor: pointer; }
        .btn-primary { background-color: #007bff; color: white; }
        .btn-success { background-color: #28a745; color: white; }
        .btn-danger { background-color: #dc3545; color: white; }
        pre { background-color: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üß™ Frontend Debug Test</h1>
    
    <div class="test-section info">
        <h3>üìã Test Instructions</h3>
        <p>Ki·ªÉm tra c√°c ch·ª©c nƒÉng frontend ƒë·ªÉ debug v·∫•n ƒë·ªÅ redirect:</p>
        <ol>
            <li>Ki·ªÉm tra localStorage</li>
            <li>Test API calls</li>
            <li>Ki·ªÉm tra console errors</li>
            <li>Test navigation logic</li>
        </ol>
    </div>

    <div class="test-section">
        <h3>üîç LocalStorage Check</h3>
        <button class="btn-primary" onclick="checkLocalStorage()">Ki·ªÉm tra LocalStorage</button>
        <button class="btn-danger" onclick="clearLocalStorage()">X√≥a LocalStorage</button>
        <div id="localStorageResult"></div>
    </div>

    <div class="test-section">
        <h3>üåê API Test</h3>
        <button class="btn-primary" onclick="testClubStatus()">Test Club Status</button>
        <button class="btn-primary" onclick="testAvailableClubs()">Test Available Clubs</button>
        <div id="apiResult"></div>
    </div>

    <div class="test-section">
        <h3>üöÄ Navigation Test</h3>
        <button class="btn-success" onclick="testNavigation()">Test Navigation Logic</button>
        <div id="navigationResult"></div>
    </div>

    <div class="test-section">
        <h3>üìä Console Monitor</h3>
        <button class="btn-primary" onclick="startConsoleMonitor()">B·∫Øt ƒë·∫ßu Monitor</button>
        <button class="btn-danger" onclick="stopConsoleMonitor()">D·ª´ng Monitor</button>
        <div id="consoleLog"></div>
    </div>

    <script>
        let consoleMonitor = null;

        function checkLocalStorage() {
            const result = document.getElementById('localStorageResult');
            const items = {};
            
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                items[key] = localStorage.getItem(key);
            }
            
            result.innerHTML = `
                <h4>LocalStorage Contents:</h4>
                <pre>${JSON.stringify(items, null, 2)}</pre>
            `;
        }

        function clearLocalStorage() {
            localStorage.clear();
            document.getElementById('localStorageResult').innerHTML = '<p class="success">‚úÖ LocalStorage ƒë√£ ƒë∆∞·ª£c x√≥a</p>';
        }

        async function testClubStatus() {
            const result = document.getElementById('apiResult');
            result.innerHTML = '<p>üîÑ ƒêang test...</p>';
            
            try {
                const response = await fetch('https://api.lienketso.vn/public/api/clubs/status?user_id=5', {
                    headers: { 'Accept': 'application/json' }
                });
                
                const data = await response.json();
                result.innerHTML = `
                    <h4>Club Status API Response:</h4>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch (error) {
                result.innerHTML = `<p class="error">‚ùå Error: ${error.message}</p>`;
            }
        }

        async function testAvailableClubs() {
            const result = document.getElementById('apiResult');
            result.innerHTML = '<p>üîÑ ƒêang test...</p>';
            
            try {
                const response = await fetch('https://api.lienketso.vn/public/api/clubs/available?user_id=5', {
                    headers: { 'Accept': 'application/json' }
                });
                
                const data = await response.json();
                result.innerHTML = `
                    <h4>Available Clubs API Response:</h4>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch (error) {
                result.innerHTML = `<p class="error">‚ùå Error: ${error.message}</p>`;
            }
        }

        function testNavigation() {
            const result = document.getElementById('navigationResult');
            
            // Simulate navigation logic
            const currentClubId = localStorage.getItem('current_club_id');
            const hasClubs = localStorage.getItem('user_id');
            
            const logic = {
                currentClubId,
                hasClubs,
                shouldRedirect: false,
                reason: 'Kh√¥ng c√≥ l√Ω do redirect'
            };
            
            if (currentClubId && hasClubs) {
                logic.shouldRedirect = false;
                logic.reason = 'User c√≥ club v√† ƒë√£ ch·ªçn - KH√îNG redirect (ƒë√£ s·ª≠a)';
            } else if (hasClubs) {
                logic.shouldRedirect = false;
                logic.reason = 'User c√≥ club nh∆∞ng ch∆∞a ch·ªçn - KH√îNG redirect';
            } else {
                logic.shouldRedirect = false;
                logic.reason = 'User kh√¥ng c√≥ club - KH√îNG redirect';
            }
            
            result.innerHTML = `
                <h4>Navigation Logic Test:</h4>
                <pre>${JSON.stringify(logic, null, 2)}</pre>
            `;
        }

        function startConsoleMonitor() {
            if (consoleMonitor) return;
            
            const originalLog = console.log;
            const originalError = console.error;
            const originalWarn = console.warn;
            
            const logDiv = document.getElementById('consoleLog');
            logDiv.innerHTML = '<h4>Console Monitor Started:</h4>';
            
            console.log = function(...args) {
                originalLog.apply(console, args);
                logDiv.innerHTML += `<p style="color: #007bff;">üìù LOG: ${args.join(' ')}</p>`;
            };
            
            console.error = function(...args) {
                originalError.apply(console, args);
                logDiv.innerHTML += `<p style="color: #dc3545;">‚ùå ERROR: ${args.join(' ')}</p>`;
            };
            
            console.warn = function(...args) {
                originalWarn.apply(console, args);
                logDiv.innerHTML += `<p style="color: #ffc107;">‚ö†Ô∏è WARN: ${args.join(' ')}</p>`;
            };
            
            consoleMonitor = { originalLog, originalError, originalWarn };
            logDiv.innerHTML += '<p class="success">‚úÖ Console monitor ƒë√£ b·∫Øt ƒë·∫ßu</p>';
        }

        function stopConsoleMonitor() {
            if (!consoleMonitor) return;
            
            console.log = consoleMonitor.originalLog;
            console.error = consoleMonitor.originalError;
            console.warn = consoleMonitor.originalWarn;
            
            consoleMonitor = null;
            document.getElementById('consoleLog').innerHTML += '<p class="success">‚úÖ Console monitor ƒë√£ d·ª´ng</p>';
        }

        // Auto-check localStorage on load
        window.addEventListener('load', () => {
            checkLocalStorage();
            testNavigation();
        });
    </script>
</body>
</html>
